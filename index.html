<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Biscuit-o's Files | Released Documents</title>

<!-- Favicon from repo root -->
<link rel="icon" href="/favicon.png">

<style>
:root {
    --bg: #f6f7f9;
    --card: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --border: #e5e7eb;
    --accent: #2563eb;
}

* { box-sizing: border-box; }

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: system-ui, -apple-system, BlinkMacSystemFont,
                 "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    transition: transform 1s ease-in-out;
}

/* Spin */
body.spin {
    transform: rotate(360deg);
}

/* Lock screen */
.locked {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
    text-align: center;
}

.locked h1 {
    font-size: 28px;
}

.locked p {
    color: var(--muted);
}

/* Header */
.header {
    background: var(--card);
    border-bottom: 1px solid var(--border);
}

.header-inner {
    max-width: 960px;
    margin: 0 auto;
    padding: 32px 24px;
}

.header h1 {
    margin: 0 0 6px;
    font-size: 26px;
    font-weight: 600;
}

.header p {
    margin: 0;
    color: var(--muted);
    font-size: 14px;
}

/* Main */
.main {
    max-width: 960px;
    margin: 0 auto;
    padding: 32px 24px 64px;
}

/* Search */
.search input {
    width: 100%;
    padding: 14px 16px;
    font-size: 15px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--card);
}

.search input:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(37,99,235,0.15);
    outline: none;
}

/* Files */
.file-list {
    margin-top: 28px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.file {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 18px 20px;
    display: flex;
    justify-content: space-between;
    transition: 0.15s ease;
}

.file:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.06);
}

.file-name a {
    text-decoration: none;
    color: var(--text);
    font-weight: 500;
}

.file:hover .file-name a {
    color: var(--accent);
}

.file-meta {
    color: var(--muted);
    font-size: 13px;
}

/* Empty */
.empty {
    text-align: center;
    color: var(--muted);
    padding: 48px 0;
}
</style>
</head>

<body>

<div id="app">

<div class="header">
    <div class="header-inner">
        <h1>Released Documents</h1>
        <p>Hirsch Library · Public Access Archive · Satirical Material</p>
    </div>
</div>

<div class="main">
    <div class="search">
        <input id="searchBar" placeholder="Search documents…" onkeyup="filterFiles()">
    </div>

    <div class="file-list" id="fileList">Loading…</div>
</div>

</div>

<script>
const LOCK_KEY = "site_lock_until";
const EXEMPT_KEY = "lock_exempt";
const LOCK_DURATION = 15 * 60 * 1000;

let allFiles = [];

/* Lock check */
(function checkLock() {
    const lockUntil = localStorage.getItem(LOCK_KEY);
    const exempt = localStorage.getItem(EXEMPT_KEY);

    if (lockUntil && Date.now() < lockUntil && !exempt) {
        document.body.innerHTML = `
            <div class="locked">
                <div>
                    <h1>Site Temporarily Locked</h1>
                    <p>Please try again later.</p>
                </div>
            </div>
        `;
    }
})();

async function loadFiles() {
    const res = await fetch("files.json");
    allFiles = await res.json();
    renderFiles(allFiles);
}

function getExtension(file) {
    return file.split(".").pop().toUpperCase();
}

function renderFiles(files) {
    const list = document.getElementById("fileList");
    list.innerHTML = "";

    if (!files.length) {
        list.innerHTML = `<div class="empty">No documents found.</div>`;
        return;
    }

    files.forEach(file => {
        const div = document.createElement("div");
        div.className = "file";

        div.innerHTML = `
            <div class="file-name">
                <a href="files/${file}" target="_blank">${file}</a>
            </div>
            <div class="file-meta">${getExtension(file)}</div>
        `;

        list.appendChild(div);
    });
}

function filterFiles() {
    const q = searchBar.value.toLowerCase();
    renderFiles(allFiles.filter(f => f.toLowerCase().includes(q)));
}

/* CTRL + G */
document.addEventListener("keydown", e => {
    if (e.ctrlKey && e.key.toLowerCase() === "g") {
        e.preventDefault();
        const input = prompt("Enter access phrase:");

        if (input === "aidenfilesontop") {
            document.body.classList.add("spin");
            setTimeout(() => document.body.classList.remove("spin"), 1000);
        }

        if (input === "3214321422222222iiiiiiii") {
            localStorage.setItem(LOCK_KEY, Date.now() + LOCK_DURATION);
            localStorage.setItem(EXEMPT_KEY, "true");
            alert("Lockdown initiated for 15 minutes.");
        }
    }
});

loadFiles();
</script>

</body>
</html>
